<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FTNQ</title>
    <link rel="stylesheet" type="text/css" href="css/app.css">

    <!-- update the version number as needed -->
    <!-- include only the Firebase features as you need -->
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-functions.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>

</head>
<body>
<div class="topbar">
    <h2>FTNQ</h2>
</div>
<div class="wrapper">

    Logging out...

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // The Firebase SDK is initialized

            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    //Logged in
                    console.log(user);

                    //Remove user from room, if any
                    let ftnqRemoveUserFromRoom = firebase.functions().httpsCallable('removeUserFromRoom');
                    ftnqRemoveUserFromRoom({userToRemove: user.uid}).then(function (result) {
                        console.log("removed user from room, and room from user (if any)");
                    });

                    //logout
                    firebase.auth().signOut();
                } else {
                    //Logged out
                    window.location = 'index.html'
                }
            });

            try {
                let app = firebase.app();
                console.log("Firebase loaded");
            } catch (e) {
                console.error(e);
            }
        });
    </script>
</div>
</body>
</html>